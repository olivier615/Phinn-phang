"use strict";(self["webpackChunkweek8"]=self["webpackChunkweek8"]||[]).push([[192],{1192:function(e,t,a){a.r(t),a.d(t,{default:function(){return ne}});var s=a(6252),l=a(9963),o=a(3577);const n={class:"home container mt-80"},r={class:"row justify-content-center mt-4 flex-md-row flex-column"},i={class:"col-md-5 col-12 mt-5"},d=(0,s._)("h4",{class:"text-center mt-5 text-secondary fw-bolder mb-4"},"使用優惠券",-1),c={class:"input-group my-3"},m={key:0},u=(0,s._)("span",{class:"spinner-border spinner-border-sm fs-5 me-2",role:"status"},null,-1),p=(0,s._)("span",null,"請稍後...",-1),h=[u,p],_={key:1},b={key:0,class:"alert alert-primary",role:"alert"},g={class:"col-md-4 col-12 mt-5"},f=(0,s._)("h4",{class:"text-center mb-4 text-secondary fw-bolder"},"聯絡資訊",-1),w=(0,s._)("p",{class:"text-secondary"},[(0,s._)("small",null,"標註"),(0,s._)("span",{class:"text-danger"}," * "),(0,s._)("small",null,"為必須填寫")],-1),v={class:"mb-3"},x=(0,s._)("label",{for:"email",class:"form-label"},[(0,s.Uk)("Email "),(0,s._)("span",{class:"text-danger"},"*")],-1),y={class:"mb-3"},k=(0,s._)("label",{for:"name",class:"form-label"},[(0,s.Uk)("姓名 "),(0,s._)("span",{class:"text-danger"},"*")],-1),C={class:"mb-3"},L=(0,s._)("label",{for:"tel",class:"form-label"},[(0,s.Uk)("電話 "),(0,s._)("span",{class:"text-danger"},"*")],-1),V={class:"mb-3"},T=(0,s._)("label",{for:"address",class:"form-label"},[(0,s.Uk)("地址 "),(0,s._)("span",{class:"text-danger"},"*")],-1),U={class:"mb-3"},W=(0,s._)("label",{for:"message",class:"form-label"},"留言",-1),D={class:"text-center text-md-end"},z=["disabled","onClick"],$={key:0},F=(0,s._)("span",{class:"spinner-border spinner-border-sm fs-5 me-2",role:"status"},null,-1),q=(0,s._)("span",null,"請稍後...",-1),Z=[F,q],P={key:1};function M(e,t,a,u,p,F){const q=(0,s.up)("CartList"),M=(0,s.up)("FieldTemp"),S=(0,s.up)("error-message"),j=(0,s.up)("FormTemp");return(0,s.wg)(),(0,s.iD)("div",n,[(0,s._)("div",r,[(0,s._)("div",i,[(0,s.Wm)(q,{"new-final-total":p.newFinalTotal},null,8,["new-final-total"]),d,(0,s._)("div",c,[(0,s.wy)((0,s._)("input",{type:"text",class:"form-control",placeholder:"請輸入優惠券代碼","aria-label":"couponCode","aria-describedby":"couponCode","onUpdate:modelValue":t[0]||(t[0]=e=>p.couponCode=e)},null,512),[[l.nr,p.couponCode]]),(0,s._)("button",{class:"btn btn-outline-primary",type:"button",id:"couponCode",onClick:t[1]||(t[1]=(...e)=>F.submitCouponCode&&F.submitCouponCode(...e))},[!0===p.isLoading?((0,s.wg)(),(0,s.iD)("div",m,h)):((0,s.wg)(),(0,s.iD)("span",_,"使用優惠券"))])]),""!==p.couponMassage?((0,s.wg)(),(0,s.iD)("div",b,(0,o.zw)(p.couponMassage),1)):(0,s.kq)("",!0)]),(0,s._)("div",g,[f,w,(0,s.Wm)(j,{onSubmit:F.onSubmit,class:"text-secondary"},{default:(0,s.w5)((({errors:e,validate:a})=>[(0,s._)("div",v,[x,(0,s.Wm)(M,{id:"email",name:"email",type:"email",class:(0,o.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:p.form.user.email,"onUpdate:modelValue":t[2]||(t[2]=e=>p.form.user.email=e)},null,8,["class","modelValue"]),(0,s.Wm)(S,{name:"email",class:"invalid-feedback"})]),(0,s._)("div",y,[k,(0,s.Wm)(M,{id:"name",name:"姓名",type:"text",class:(0,o.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:p.form.user.name,"onUpdate:modelValue":t[3]||(t[3]=e=>p.form.user.name=e)},null,8,["class","modelValue"]),(0,s.Wm)(S,{name:"姓名",class:"invalid-feedback"})]),(0,s._)("div",C,[L,(0,s.Wm)(M,{id:"tel",name:"電話",type:"tel",class:(0,o.C_)(["form-control",{"is-invalid":e["電話"]}]),placeholder:"請輸入電話",rules:"numeric|required|min:8|max:10",modelValue:p.form.user.tel,"onUpdate:modelValue":t[4]||(t[4]=e=>p.form.user.tel=e)},null,8,["class","modelValue"]),(0,s.Wm)(S,{name:"電話",class:"invalid-feedback"})]),(0,s._)("div",V,[T,(0,s.Wm)(M,{id:"address",name:"地址",type:"text",class:(0,o.C_)(["form-control",{"is-invalid":e["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:p.form.user.address,"onUpdate:modelValue":t[5]||(t[5]=e=>p.form.user.address=e)},null,8,["class","modelValue"]),(0,s.Wm)(S,{name:"地址",class:"invalid-feedback"})]),(0,s._)("div",U,[W,(0,s.wy)((0,s._)("textarea",{id:"message",class:"form-control",cols:"15",rows:"5","onUpdate:modelValue":t[6]||(t[6]=e=>p.form.message=e)},null,512),[[l.nr,p.form.message]])]),(0,s._)("div",D,[(0,s._)("button",{class:"btn btn-outline-secondary me-2",onClick:t[7]||(t[7]=(...e)=>F.backToPreviousPage&&F.backToPreviousPage(...e))}," 回上一頁 "),(0,s._)("button",{disabled:Object.keys(e).length>0||0===p.carts.carts?.length,class:"btn btn-primary",type:"submit",onClick:a},[!0===p.isLoading?((0,s.wg)(),(0,s.iD)("div",$,Z)):((0,s.wg)(),(0,s.iD)("span",P,"送出訂單"))],8,z)])])),_:1},8,["onSubmit"])])])])}var S=a(4902);const j=(0,s._)("h4",{class:"text-center mb-4 text-secondary fw-bolder"},"訂單內容",-1),E={class:"table"},H=(0,s._)("thead",{class:"text-secondary"},[(0,s._)("tr",null,[(0,s._)("th",null,"#"),(0,s._)("th",null,"品名"),(0,s._)("th",null,"數量"),(0,s._)("th",null,"售價")])],-1),Y={class:"text-secondary"},I={class:"d-flex"},K={class:"pt-1 m-0"},O={class:"text-secondary"},A=(0,s._)("td",{colspan:"3",class:"text-end"},"小計",-1),B={class:"text-end"},G={key:0},J=(0,s._)("td",{colspan:"3",class:"text-end"},"折扣",-1),N={class:"text-end"},Q=(0,s._)("td",{colspan:"3",class:"text-end"},"總計",-1),R={class:"text-end"};function X(e,t,a,l,n,r){const i=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)(s.HY,null,[j,(0,s._)("table",E,[H,(0,s._)("tbody",Y,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.carts.carts,((e,t)=>((0,s.wg)(),(0,s.iD)("tr",{key:e},[(0,s._)("th",null,(0,o.zw)(t+1),1),(0,s._)("td",null,[(0,s.Wm)(i,{to:`/product/${e.product.id}`,class:"mb-0"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)(e.product.title),1)])),_:2},1032,["to"])]),(0,s._)("td",null,[(0,s._)("div",I,[(0,s._)("p",K,(0,o.zw)(e.qty)+(0,o.zw)(e.product.unit),1)])]),(0,s._)("td",null,(0,o.zw)(e.total),1)])))),128))]),(0,s._)("tfoot",O,[(0,s._)("tr",null,[A,(0,s._)("td",B,(0,o.zw)(n.carts.total),1)]),n.carts.total-n.carts.final_total!==0?((0,s.wg)(),(0,s.iD)("tr",G,[J,(0,s._)("td",N,(0,o.zw)(n.carts.total-n.carts.final_total),1)])):(0,s.kq)("",!0),(0,s._)("tr",null,[Q,(0,s._)("td",R,(0,o.zw)(n.carts.final_total),1)])])])],64)}var ee={data(){return{carts:[],form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCarts(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/otispath/cart").then((e=>{this.carts=e.data.data})).catch((e=>{alert(e)}))}},props:["newFinalTotal"],watch:{newFinalTotal(){this.carts.final_total=this.newFinalTotal}},mounted(){this.getCarts()}},te=a(3744);const ae=(0,te.Z)(ee,[["render",X]]);var se=ae,le={components:{CartList:se},data(){return{isLoading:"",carts:[],form:{user:{name:"",email:"",tel:"",address:""},message:""},couponCode:"",couponMassage:"",newFinalTotal:0}},methods:{onSubmit(){this.isLoading=!0,this.$http.post("https://vue3-course-api.hexschool.io/v2/api/otispath/order",{data:this.form}).then((e=>{S.Z.emit("get-cart");const t=e.data.orderId;this.$router.push(`/payment/${t}`),this.isLoading=""})).catch((e=>{alert(e),this.isLoading=""}))},getCarts(){S.Z.emit("page-loading",!0),this.isLoading=!0,this.$http.get("https://vue3-course-api.hexschool.io/v2/api/otispath/cart").then((e=>{this.carts=e.data.data,this.isLoading="",S.Z.emit("page-loading",!1)})).catch((e=>{alert(e),this.isLoading="",S.Z.emit("page-loading",!1)}))},backToPreviousPage(){this.$router.back(-1)},submitCouponCode(){this.isLoading=!0,this.$http.post("https://vue3-course-api.hexschool.io/v2/api/otispath/coupon",{data:{code:this.couponCode}}).then((e=>{this.newFinalTotal=e.data.data.final_total,this.couponMassage=e.data.message,S.Z.emit("get-cart"),this.getCarts(),this.isLoading=""})).catch((e=>{this.$httpMessageState(e.response,"輸入優惠券"),this.isLoading=""}))}},mounted(){window.scroll(0,0),this.getCarts()}};const oe=(0,te.Z)(le,[["render",M]]);var ne=oe}}]);
//# sourceMappingURL=192.e3984350.js.map