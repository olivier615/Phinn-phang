"use strict";(self["webpackChunkweek8"]=self["webpackChunkweek8"]||[]).push([[166],{9280:function(t,e,a){a.d(e,{Z:function(){return g}});var i=a(6252),d=a(3577),s=a(9963);const o={"aria-label":"Page navigation example"},n={class:"pagination"},l=["onClick"];function r(t,e,a,r,c,u){return(0,i.wg)(),(0,i.iD)("nav",o,[(0,i._)("ul",n,[(0,i._)("li",{class:(0,d.C_)(["page-item",{disabled:!a.pages.has_pre}])},[(0,i._)("a",{class:"page-link",href:"#",onClick:e[0]||(e[0]=(0,s.iM)((e=>t.$emit("getProducts",a.pages.current_page-1)),["prevent"]))},"上一頁")],2),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.pages.total_pages,(e=>((0,i.wg)(),(0,i.iD)("li",{class:(0,d.C_)(["page-item",{active:e===a.pages.current_page}]),key:"page"+e},[(0,i._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((a=>t.$emit("getProducts",e)),["prevent"])},(0,d.zw)(e),9,l)],2)))),128)),(0,i._)("li",{class:(0,d.C_)(["page-item",{disabled:!a.pages.has_next}])},[(0,i._)("a",{class:"page-link",href:"#",onClick:e[1]||(e[1]=(0,s.iM)((e=>t.$emit("getProducts",a.pages.current_page+1)),["prevent"]))},"下一頁")],2)])])}var c={props:["pages"]},u=a(3744);const p=(0,u.Z)(c,[["render",r]]);var g=p},3166:function(t,e,a){a.r(e),a.d(e,{default:function(){return O}});var i=a(6252),d=a(3577);const s={class:"container"},o=(0,i._)("h2",null,"後台-產品列表",-1),n={class:"text-end mt-4"},l={class:"table mt-4"},r=(0,i._)("thead",null,[(0,i._)("tr",null,[(0,i._)("th",{width:"120"},"分類"),(0,i._)("th",null,"產品名稱"),(0,i._)("th",{width:"120"},"促銷方式"),(0,i._)("th",{width:"60"},"原價"),(0,i._)("th",{width:"60"},"售價"),(0,i._)("th",{width:"100"},"是否啟用"),(0,i._)("th",{width:"120"},"編輯")])],-1),c={class:"d-flex"},u={class:"text-end"},p={class:"text-end"},g={key:0,class:"text-success"},h={key:1},_={class:"btn-group"},m=(0,i.Uk)(" 編輯 "),b=["onClick"];function w(t,e,a,w,P,v){const k=(0,i.up)("Loading"),f=(0,i.up)("router-link"),y=(0,i.up)("pagination"),C=(0,i.up)("deleteProduct");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",s,[(0,i.Wm)(k,{active:P.isLoading,"z-index":1060},null,8,["active"]),o,(0,i._)("div",n,[(0,i._)("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=t=>v.openProductPage("new"))}," 建立新的產品 ")]),(0,i._)("table",l,[r,(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(P.products,(t=>((0,i.wg)(),(0,i.iD)("tr",{key:t.id},[(0,i._)("td",null,(0,d.zw)(t.category),1),(0,i._)("td",null,(0,d.zw)(t.title),1),(0,i._)("td",null,[(0,i._)("div",c,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.promotion,(e=>((0,i.wg)(),(0,i.iD)("span",{key:e+t.title,class:(0,d.C_)([{"bg-primary":"新品"===e,"bg-danger":"熱門"===e,"bg-success":"特價"===e},"badge rounded-pill me-1"])},(0,d.zw)(e),3)))),128))])]),(0,i._)("td",u,(0,d.zw)(t.origin_price),1),(0,i._)("td",p,(0,d.zw)(t.price),1),(0,i._)("td",null,[t.is_enabled?((0,i.wg)(),(0,i.iD)("span",g,"啟用")):((0,i.wg)(),(0,i.iD)("span",h,"未啟用"))]),(0,i._)("td",null,[(0,i._)("div",_,[(0,i.Wm)(f,{to:`/admin/product/${t.id}`,class:"btn btn-outline-primary btn-sm"},{default:(0,i.w5)((()=>[m])),_:2},1032,["to"]),(0,i._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>v.OpenDeleteProductModal(t)}," 刪除 ",8,b)])])])))),128))])]),(0,i.Wm)(y,{pages:P.pagination,onGetProducts:v.getProducts},null,8,["pages","onGetProducts"])]),(0,i.Wm)(C,{"edit-product":P.editProduct,ref:"delProductModal",onUpdate:e[1]||(e[1]=t=>v.getProducts(P.pagination.current_page))},null,8,["edit-product"])],64)}var P=a(9280);const v={id:"delProductModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},k={class:"modal-dialog"},f={class:"modal-content border-0"},y=(0,i._)("div",{class:"modal-header bg-danger text-white"},[(0,i._)("h5",{id:"delProductModalLabel",class:"modal-title"},[(0,i._)("span",null,"刪除產品")]),(0,i._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),C={class:"modal-body"},$=(0,i.Uk)(" 是否刪除 "),M={class:"text-danger"},x=(0,i.Uk)(" (商品刪除後將無法恢復)。 "),D={class:"modal-footer"},z=(0,i._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function L(t,e,a,s,o,n){return(0,i.wg)(),(0,i.iD)("div",v,[(0,i._)("div",k,[(0,i._)("div",f,[y,(0,i._)("div",C,[$,(0,i._)("strong",M,(0,d.zw)(a.editProduct.title),1),x]),(0,i._)("div",D,[z,(0,i._)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...t)=>n.deleteProduct&&n.deleteProduct(...t))}," 確認刪除 ")])])])],512)}var U=a(7424),Z=a.n(U),H={data(){return{modal:""}},props:["editProduct"],methods:{deleteProduct(){this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/otispath/admin/product/${this.editProduct.id}`).then((t=>{alert(t.data.message),this.hideModal(),this.$emit("update")})).catch((t=>{alert(t.data.message)}))},openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(Z())(this.$refs.modal,{keyboard:!1,backdrop:"static"})}},W=a(3744);const Y=(0,W.Z)(H,[["render",L]]);var K=Y,N={components:{pagination:P.Z,deleteProduct:K},data(){return{isLoading:!1,url:"https://vue3-course-api.hexschool.io/v2",path:"otispath",products:[],editProduct:{imagesUrl:[],promotion:[]},isNew:!1,pagination:{}}},methods:{getProducts(t=1){this.isLoading=!0,this.$http.get(`${this.url}/api/${this.path}/admin/products/?page=${t}`).then((t=>{this.products=t.data.products,this.pagination=t.data.pagination,this.isLoading=!1})).catch((()=>{this.isLoading=!1,alert("無法取得產品列表")}))},openProductPage(t,e){"new"===t?(this.editProduct={imagesUrl:[],promotion:[]},this.isNew=!0,this.$router.push("/admin/product")):"edit"===t&&(this.editProduct={imagesUrl:[],promotion:[]},this.editProduct={...e},this.isNew=!1,this.$router.push("/product/:id"))},OpenDeleteProductModal(t){this.editProduct={...t},this.$refs.delProductModal.openModal()}},mounted(){this.getProducts()}};const G=(0,W.Z)(N,[["render",w]]);var O=G}}]);
//# sourceMappingURL=166.4853f623.js.map