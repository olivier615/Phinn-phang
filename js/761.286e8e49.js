"use strict";(self["webpackChunkweek8"]=self["webpackChunkweek8"]||[]).push([[761],{9513:function(t,e,s){s.r(e),s.d(e,{default:function(){return dt}});var a=s(6252),l=s(3577),i=s(9963);const d={class:"container mt-80"},o={class:"row justify-content-center mb-7"},n={key:0,class:"col-12 col-md-10"},r=(0,a._)("h3",{class:"text-center m-3 text-secondary fw-bolder mt-5"}," 您的購物車 ",-1),c={class:"table text-secondary"},h=(0,a._)("thead",{class:"text-secondary"},[(0,a._)("tr",null,[(0,a._)("th",{class:"d-none d-md-table-cell"},"#"),(0,a._)("th",null,"品名"),(0,a._)("th",null,"數量"),(0,a._)("th",{class:"d-none d-md-table-cell"},"售價"),(0,a._)("th")])],-1),u={class:"d-none d-md-table-cell"},p={class:"d-md-none d-black"},m=(0,a._)("br",null,null,-1),b={class:"d-flex"},g=["onClick"],_=(0,a._)("span",{class:"bi bi-dash fs-4 px-1"},null,-1),y=[_],w=["onUpdate:modelValue","onChange"],v=["onClick"],f=(0,a._)("span",{class:"bi bi-plus fs-4 px-1"},null,-1),k=[f],C={class:"pt-1 m-0 d-md-black d-none"},x={class:"d-none d-md-table-cell"},L={key:0,class:"spinner-border spinner-border-sm fs-5 text-primary",role:"status"},M={key:1,href:""},D=["onClick"],$={class:"text-secondary"},Z=(0,a._)("td",{colspan:"4",class:"text-end d-none d-md-table-cell"},"總計",-1),P=(0,a._)("td",{colspan:"2",class:"text-end d-table-cell d-md-none"},"總計",-1),q={class:"text-end"},U={class:"d-flex justify-content-between"},z=["disabled"],W={key:0,class:"spinner-border spinner-border-sm fs-5 text-secondary",role:"status"},N=(0,a.Uk)("清空購物車 "),I=["disabled"],O={key:1,class:"text-center text-primary mt-6"},T=(0,a._)("h3",null,"購物車還是空的！",-1),j={class:"mt-3"},H=(0,a.Uk)(" 再去逛逛 ");function S(t,e,s,_,f,S){const V=(0,a.up)("router-link"),Y=(0,a.up)("swiper"),K=(0,a.up)("DeleteCart");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",d,[(0,a._)("div",o,[0!==f.carts.carts?.length?((0,a.wg)(),(0,a.iD)("div",n,[r,(0,a._)("table",c,[h,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(f.carts.carts,((t,e)=>((0,a.wg)(),(0,a.iD)("tr",{key:t},[(0,a._)("th",u,(0,l.zw)(e+1),1),(0,a._)("td",null,[(0,a.Wm)(V,{to:`/product/${t.product.id}`,class:"mb-0"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(t.product.title),1)])),_:2},1032,["to"]),(0,a._)("span",p,[m,(0,a.Uk)((0,l.zw)(t.total)+" 元",1)])]),(0,a._)("td",null,[(0,a._)("div",b,[(0,a._)("a",{href:"",onClick:(0,i.iM)((s=>S.editNum("minus",e,t)),["prevent"])},y,8,g),(0,a.wy)((0,a._)("input",{type:"number",class:"form-control p-0 text-center text-primary","onUpdate:modelValue":e=>t.qty=e,onChange:s=>S.editNum("edit",e,t),min:"1",style:{"max-width":"3rem","min-width":"2rem"}},null,40,w),[[i.nr,t.qty,void 0,{number:!0}]]),(0,a._)("a",{href:"",onClick:(0,i.iM)((s=>S.editNum("add",e,t)),["prevent"])},k,8,v),(0,a._)("p",C,(0,l.zw)(t.product.unit),1)])]),(0,a._)("td",x,(0,l.zw)(t.total),1),(0,a._)("td",null,[f.isLoading===t.id?((0,a.wg)(),(0,a.iD)("span",L)):((0,a.wg)(),(0,a.iD)("a",M,[(0,a._)("span",{class:"bi bi-trash3 fs-5 text-primary",onClick:(0,i.iM)((e=>S.deleteItem(t)),["prevent"])},null,8,D)]))])])))),128))]),(0,a._)("tfoot",$,[(0,a._)("tr",null,[Z,P,(0,a._)("td",q,(0,l.zw)(f.carts.total),1)])])]),(0,a._)("div",U,[(0,a._)("button",{class:"btn btn-outline-secondary",onClick:e[0]||(e[0]=(...t)=>S.OpenDeleteCartsModal&&S.OpenDeleteCartsModal(...t)),disabled:!0===f.isLoading||""!==f.isLoading},[(0,a._)("span",null,[!0===f.isLoading?((0,a.wg)(),(0,a.iD)("span",W)):(0,a.kq)("",!0),N])],8,z),(0,a.Wm)(V,{to:"/order"},{default:(0,a.w5)((()=>[(0,a._)("button",{class:"btn btn-primary",disabled:!0===f.isLoading||""!==f.isLoading},"開始結帳",8,I)])),_:1})])])):((0,a.wg)(),(0,a.iD)("div",O,[T,(0,a._)("div",j,[(0,a._)("button",{onClick:e[1]||(e[1]=(...t)=>S.backToPreviousPage&&S.backToPreviousPage(...t)),type:"button",class:"btn btn-outline-secondary me-1"}," 回上一頁 "),(0,a.Wm)(V,{to:"/products",class:"btn btn-primary ms-1"},{default:(0,a.w5)((()=>[H])),_:1})])]))])]),(0,a.Wm)(Y),(0,a.Wm)(K,{ref:"DeleteCartsModal",onUpdate:S.getCarts},null,8,["onUpdate"])],64)}var V=s(4902);const Y={id:"delProductModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},K={class:"modal-dialog"},A={class:"modal-content border-0"},B=(0,a._)("div",{class:"modal-header bg-primary text-white"},[(0,a._)("h5",{id:"delProductModalLabel",class:"modal-title"},[(0,a._)("span",null,"刪除購物車")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),E=(0,a._)("div",{class:"modal-body text-secondary"}," 確認刪除購物車商品 (購物車商品刪除後將無法恢復)。 ",-1),F={class:"modal-footer"},G=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function J(t,e,s,l,i,d){return(0,a.wg)(),(0,a.iD)("div",Y,[(0,a._)("div",K,[(0,a._)("div",A,[B,E,(0,a._)("div",F,[G,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=(...t)=>d.deleteCarts&&d.deleteCarts(...t))}," 確認刪除 ")])])])],512)}var Q=s(7424),R=s.n(Q),X={data(){return{modal:""}},props:["editProduct"],methods:{deleteCarts(){this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/otispath/carts").then((t=>{alert(t.data.message),this.hideModal(),this.$emit("update")})).catch((t=>{alert(t.data.message)}))},openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(R())(this.$refs.modal,{keyboard:!1,backdrop:"static"})}},tt=s(3744);const et=(0,tt.Z)(X,[["render",J]]);var st=et,at=s(8902),lt={components:{swiper:at.Z,DeleteCart:st},data(){return{carts:[],isLoading:""}},methods:{getCarts(){V.Z.emit("page-loading",!0),this.$http.get("https://vue3-course-api.hexschool.io/v2/api/otispath/cart").then((t=>{this.carts=t.data.data,V.Z.emit("page-loading",!1)})).catch((t=>{alert(t),V.Z.emit("page-loading",!1)}))},editNum(t,e,s){if(this.isLoading=s.id,"add"===t)this.carts.carts[e].qty+=1;else if("minus"===t&&(this.carts.carts[e].qty-=1,0===this.carts.carts[e].qty))return void this.deleteItem(s);const a={product_id:s.product.id,qty:this.carts.carts[e].qty};this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/otispath/cart/${s.id}`,{data:a}).then((t=>{this.getCarts(),V.Z.emit("get-cart"),this.isLoading=""})).catch(this.isLoading="")},OpenDeleteCartsModal(){this.$refs.DeleteCartsModal.openModal()},deleteItem(t){this.isLoading=t.id,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/otispath/cart/${t.id}`).then((t=>{this.getCarts(),V.Z.emit("get-cart"),this.$httpMessageState(t,"刪除商品"),this.isLoading=""})).catch((t=>{console.dir(t),this.isLoading=""}))},deleteCart(){this.isLoading=!0,this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/otispath/carts").then((t=>{window.scroll(0,0),this.getCarts(),V.Z.emit("get-cart"),this.$httpMessageState(t,"清除購物車"),this.isLoading=""})).catch((t=>{console.dir(t),this.isLoading=""}))},backToPreviousPage(){this.$router.back(-1)}},mounted(){window.scroll(0,0),this.getCarts(),V.Z.on("get-cart",(()=>{this.getCarts()}))},unmounted(){V.Z.off()}};const it=(0,tt.Z)(lt,[["render",S]]);var dt=it}}]);
//# sourceMappingURL=761.286e8e49.js.map